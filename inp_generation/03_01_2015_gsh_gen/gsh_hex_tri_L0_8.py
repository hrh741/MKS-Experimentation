import numpy as np


def gsh(e_angles):

    phi1 = e_angles[0, :]
    phi = e_angles[1, :]
    phi2 = e_angles[2, :]

    zvec = np.abs(phi) < 10e-17
    zvec = zvec.astype(int)
    randvec = np.round(np.random.rand(zvec.shape[0]))
    randvecopp = np.ones(zvec.shape[0]) - randvec
    phi += (1e-7)*zvec*(randvec - randvecopp)

    out_tvalues = np.zeros([90, e_angles.shape[1]], dtype = 'complex128')

    t114 = np.cos(phi)
    t78 = 1 - t114
    t148 = np.sqrt(t78)
    t55 = 0.1e1 / t148
    t67 = np.exp((-1*1j) * phi1)
    t345 = t55 * t67
    t66 = np.exp((1j) * phi1)
    t344 = (-1*1j) * t148 * t66
    t343 = (1j) * t345
    t77 = 1 + t114
    t147 = np.sqrt(t77)
    t159 = t147 * t77
    t160 = t77 * t159
    t283 = 0.3e1 / 0.64e2 * t114
    t342 = t160 * t283
    t108 = t114 ** 2
    t152 = t114 * t108
    t155 = t152 ** 2
    t103 = t114 * t155
    t341 = -7 * t103
    t153 = t108 ** 2
    t105 = t114 * t153
    t340 = -4 * t105
    t339 = 2 * t108
    t79 = 7 * t108
    t338 = -6 * t114
    t337 = -3 * t114
    t336 = -2 * t114
    t335 = 5 * t114
    t334 = 2 * t152
    t333 = -5 * t153
    t332 = -3 * t153
    t157 = t153 ** 2
    t331 = -7 * t157
    t330 = 4 * t157
    t101 = t114 * t157
    t329 = 20 * t101
    t328 = -21 * t105
    t327 = -14 * t105
    t75 = -18 * t108
    t326 = -14 * t108
    t325 = -10 * t108
    t324 = 10 * t108
    t323 = 15 * t108
    t322 = -38 * t152
    t321 = -22 * t152
    t320 = 21 * t152
    t319 = 22 * t152
    t318 = -35 * t153
    t317 = -20 * t153
    t316 = 20 * t153
    t140 = 3 * phi2
    t146 = 2 * phi1
    t87 = t146 + t140
    t21 = np.exp((2*1j) * t87)
    t141 = -3 * phi2
    t88 = t146 + t141
    t22 = np.exp((2*1j) * t88)
    t315 = (t21 + t22) * t317
    t39 = np.exp((-2*1j) * t87)
    t40 = np.exp((-2*1j) * t88)
    t314 = (t39 + t40) * t317
    t91 = phi1 + 2 * phi2
    t17 = np.exp((3*1j) * t91)
    t94 = phi1 - 2 * phi2
    t18 = np.exp((3*1j) * t94)
    t313 = (t17 + t18) * t319
    t139 = 6 * phi2
    t144 = 5 * phi1
    t83 = t144 + t139
    t27 = np.exp((1j) * t83)
    t142 = -6 * phi2
    t84 = t144 + t142
    t28 = np.exp((1j) * t84)
    t312 = t27 * t324 + t28 * t325
    t311 = -1 + t333
    t310 = -1 + t155
    t309 = 1 + t153
    t308 = 1 + t155
    t60 = 5 * t108 - 1
    t306 = -1 + t324
    t305 = 3 + t318
    t304 = 5 - 30 * t108
    t33 = np.exp((-1*1j) * t83)
    t34 = np.exp((-1*1j) * t84)
    t303 = t324 * t33 + t325 * t34
    t301 = t147 * t148
    t300 = 6 * t103 + t338
    t299 = t340 + 4 * t114
    t298 = t152 + 3 * t114
    t297 = (0.1e1 / 0.4e1*1j) * t114
    t296 = t339 - t309
    t295 = 1 + t339 + t332
    t294 = 4 - 8 * t108 + 24 * t155
    t293 = (-1*1j) * t301
    t292 = t114 * np.sqrt(0.77e2) * t160
    t291 = t114 * t301
    t290 = 2 * t103 + t340 + t334
    t289 = -2 * t105 + t336 + 4 * t152
    t288 = t105 + t337 + t334
    t287 = t105 + t114 - 2 * t152
    t113 = np.sin(phi)
    t100 = t113 ** 2
    t135 = np.sqrt(0.6e1)
    t286 = -t100 * t135 / 0.4e1
    t285 = -6 * t105 + t338 - 20 * t152
    t284 = t105 + t335 + 10 * t152
    t282 = np.sqrt(0.273e3) / 0.64e2
    t281 = np.sqrt(0.33e2) / 0.64e2
    t131 = np.sqrt(0.13e2)
    t280 = t131 / 0.64e2
    t138 = np.sqrt(0.2e1)
    t279 = t138 / 0.32e2
    t278 = t138 / 0.64e2
    t277 = t55 / 0.128e3
    t276 = 18 * t103 - 38 * t105 + t336
    t129 = np.sqrt(0.15e2)
    t275 = t129 / 0.128e3
    t274 = t138 / 0.128e3
    t273 = -5 * t108 + 5 * t153 + t310
    t272 = 7 * t153 - 3 * t155 - t60
    t271 = 1 + 9 * t108 + t333 - 5 * t155
    t270 = -t108 - t153 + t308
    t269 = 6 * t155 + 5 * t157 + t306
    t162 = t148 * t78
    t268 = (1j) * t114 * t159 * t162
    t267 = -5 + 60 * t153 - 38 * t155 + t331
    t266 = -1 - 21 * t108 + t318 - 7 * t155
    t265 = -1 + t157 + t326 + 14 * t155
    t264 = t323 + 15 * t153 + t308
    t263 = -t100 * np.sqrt(0.10e2) * (t79 - 1) / 0.8e1
    t262 = -6 - 48 * t108 + 50 * t153 + 36 * t155
    t261 = 1 + 48 * t153 - 46 * t155 + 15 * t157
    t260 = 2 - 16 * t108 + 26 * t153 - 12 * t155
    t259 = -t103 - 9 * t105 + t335 + 5 * t152
    t118 = np.sqrt(0.231e3)
    t149 = t100 ** 2
    t98 = t100 * t149
    t258 = t118 * t98 / 0.32e2
    t51 = 0.1e1 / t147
    t257 = t51 * t277
    t256 = 7 * t103 - 11 * t105 + t298
    t112 = np.sqrt(0.1430e4)
    t255 = 0.3e1 / 0.256e3 * t112 * t149 ** 2
    t254 = np.sqrt(0.70e2) * t149 / 0.16e2
    t253 = t148 * t51 / 0.128e3
    t252 = -15 * t103 + 21 * t105 - t114 - 5 * t152
    t251 = t341 - 19 * t105 - 9 * t114 + 35 * t152
    t250 = t327 + 14 * t152 - t300
    t249 = -t103 + t328 - 7 * t114 - 35 * t152
    t248 = -18 * t105 + 18 * t152 + t300
    t120 = np.sqrt(0.143e3)
    t247 = t120 * t274
    t124 = np.sqrt(0.55e2)
    t246 = 0.3e1 / 0.128e3 * t124 * t138
    t126 = np.sqrt(0.35e2)
    t245 = t126 * t159 * t297
    t244 = 16 - 210 * t153 + 196 * t155 + 30 * t157
    t243 = 12 * t101 - 14 * t103 + t327 + t338
    t242 = -17 * t103 + 7 * t105 - 11 * t114 + t320
    t241 = t341 - 69 * t105 + 29 * t114 + 15 * t152
    t240 = -25 * t103 - 77 * t105 + 17 * t114 + t320
    t239 = 30 * t103 - 10 * t105 + 18 * t114 + t322
    t238 = 715 * t155 - 1001 * t153 + 385 * t108 - 35
    t237 = t284 + t311
    t236 = t284 - t311
    t235 = -135 * t103 + t328 - 51 * t114 + 175 * t152
    t234 = 3 + t75 + t316 + 2 * t155 + t331
    t233 = t79 + 21 * t155 + t330 + t305
    t232 = (1j) * t257
    t231 = 0.3e1 / 0.64e2 * (143 * t155 - 143 * t153 + 33 * t108 - 1) * t100 * t126
    t116 = np.sqrt(0.429e3)
    t230 = (t116 * (t323 - 1) * t98) / 0.64e2
    t229 = -35 * t108 + 63 * t155 + t330 - t305
    t228 = -24 * t153 + 22 * t155 + t331 + t306
    t227 = (1j) * t147 * t277
    t121 = np.sqrt(0.105e3)
    t73 = 33 * t153
    t226 = (t100 * t121 * (t73 + t75 + 1)) / 0.32e2
    t225 = t116 * t257
    t74 = 11 * t108
    t224 = 0.3e1 / 0.32e2 * np.sqrt(0.14e2) * t149 * (t74 - 1)
    t223 = t131 * t257
    t222 = 18 * t108 - t261
    t221 = 1 + t326 + 52 * t153 - 66 * t155 + 27 * t157
    t220 = 7 - 42 * t108 + t316 + 90 * t155 - 75 * t157
    t219 = t114 * np.sqrt(0.42e2) * t147 / 0.16e2
    t218 = t138 * t147 * t283
    t76 = -26 * t108
    t217 = 0.3e1 / 0.128e3 * np.sqrt(0.154e3) * (65 * t153 + t76 + 1) * t149
    t216 = np.sqrt(0.15015e5) * t114 * t274
    t215 = (-0.1e1 / 0.2e1*1j) * t135 * t291
    t214 = t329 - 66 * t103 + 78 * t105 + 6 * t114 + t322
    t213 = t288 + t295
    t212 = t287 + t296
    t211 = t287 - t296
    t210 = t288 - t295
    t209 = t273 + t299
    t208 = t273 - t299
    t207 = t329 + 62 * t103 - 162 * t105 - 10 * t114 + 90 * t152
    t206 = (1j) * t112 * t77 * t342
    t205 = np.sqrt(0.455e3) * t232
    t204 = (1j) * t225
    t203 = t120 * t232
    t202 = np.sqrt(0.21e2) * t232
    t201 = 0.3e1 / 0.32e2 * np.sqrt(0.11e2) * t293
    t200 = t278 * t293
    t199 = t272 + t290
    t198 = -t272 + t290
    t197 = t270 + t289
    t196 = t270 - t289
    t195 = t251 + t294
    t194 = -t251 + t294
    t193 = t264 + t285
    t192 = t264 - t285
    t191 = t124 * t200
    t190 = np.sqrt(0.3e1) * t200
    t163 = t78 * t162
    t189 = (-1*1j) * np.sqrt(0.2002e4) * t163 * t60 * t342
    t188 = np.sqrt(0.2310e4) * (39 * t153 + t76 + 3) * t268 / 0.64e2
    t187 = (t121 * (t74 - 3) * t268) / 0.16e2
    t186 = t252 + t269
    t185 = -t252 + t269
    t184 = t256 + t260
    t183 = t256 - t260
    t182 = t234 + t276
    t181 = t250 + t265
    t180 = -t250 + t265
    t179 = -t234 + t276
    t178 = t241 + t262
    t177 = -t241 + t262
    t176 = t239 + t267
    t175 = t239 - t267
    t174 = t235 + t244
    t173 = -t235 + t244
    t172 = t228 + t248
    t171 = -t228 + t248
    t170 = -t221 + t243
    t169 = t221 + t243
    t168 = t214 + t222
    t167 = t214 - t222
    t166 = t207 + t220
    t165 = t207 - t220
    t145 = 4 * phi1
    t143 = 7 * phi1
    t136 = np.sqrt(0.5e1)
    t134 = np.sqrt(0.7e1)
    t96 = phi1 + t142
    t95 = phi1 + t141
    t93 = phi1 - phi2
    t92 = phi1 + phi2
    t90 = phi1 + t140
    t89 = phi1 + t139
    t86 = t145 + t141
    t85 = t145 + t140
    t82 = t143 + t142
    t81 = t143 + t139
    t80 = np.cos(t139)
    t72 = np.exp((-6*1j) * phi1)
    t71 = np.exp((-5*1j) * phi1)
    t70 = np.exp((-4*1j) * phi1)
    t69 = np.exp((-3*1j) * phi1)
    t68 = np.exp((-2*1j) * phi1)
    t65 = np.exp((2*1j) * phi1)
    t64 = np.exp((3*1j) * phi1)
    t63 = np.exp((4*1j) * phi1)
    t62 = np.exp((5*1j) * phi1)
    t61 = np.exp((6*1j) * phi1)
    t46 = np.exp((-6*1j) * t93)
    t45 = np.exp((-6*1j) * t92)
    t44 = np.exp((-3*1j) * t94)
    t43 = np.exp((-3*1j) * t91)
    t42 = np.exp((-2*1j) * t95)
    t41 = np.exp((-2*1j) * t90)
    t36 = np.exp((-1*1j) * t96)
    t35 = np.exp((-1*1j) * t89)
    t32 = np.exp((-1*1j) * t82)
    t31 = np.exp((-1*1j) * t81)
    t30 = np.exp((1j) * t96)
    t29 = np.exp((1j) * t89)
    t26 = np.exp((1j) * t82)
    t25 = np.exp((1j) * t81)
    t24 = np.exp((2*1j) * t95)
    t23 = np.exp((2*1j) * t90)
    t16 = np.exp((6*1j) * t93)
    t15 = np.exp((6*1j) * t92)
    out_tvalues[0, :] = 1
    out_tvalues[1, :] = t68 * t286
    out_tvalues[2, :] = t67 * t215
    out_tvalues[3, :] = 0.3e1 / 0.2e1 * t108 - 0.1e1 / 0.2e1
    out_tvalues[4, :] = t66 * t215
    out_tvalues[5, :] = t65 * t286
    out_tvalues[6, :] = t70 * t254
    out_tvalues[7, :] = (t108 + t336 + 1) * t69 * t55 * t245
    out_tvalues[8, :] = t68 * t263
    out_tvalues[9, :] = t136 * t147 * (7 * t152 - 7 * t108 + t337 + 3) * t297 * t345
    out_tvalues[10, :] = 0.35e2 / 0.8e1 * t153 - 0.15e2 / 0.4e1 * t108 + 0.3e1 / 0.8e1
    out_tvalues[11, :] = (-0.1e1 / 0.4e1*1j) * t66 * t136 * (t79 - 3) * t291
    out_tvalues[12, :] = t65 * t263
    out_tvalues[13, :] = t64 * t162 * t245
    out_tvalues[14, :] = t63 * t254
    out_tvalues[15, :] = -t72 * t258
    out_tvalues[16, :] = (t192 * t45 + t193 * t46) * t274
    out_tvalues[17, :] = (0.3e1 / 0.16e2*1j) * (-3 * t108 - 1 + t298) * t71 * t55 * t292
    out_tvalues[18, :] = (t236 * t33 + t237 * t34 + t303) * t190
    out_tvalues[19, :] = t70 * t224
    out_tvalues[20, :] = (t208 * t39 + t209 * t40) * t281
    out_tvalues[21, :] = t69 * t187
    out_tvalues[22, :] = (t210 * t43 + t213 * t44) * t191
    out_tvalues[23, :] = -t68 * t226
    out_tvalues[24, :] = (t196 * t41 + t197 * t42) * t246
    out_tvalues[25, :] = (33 * t105 - 33 * t153 - 30 * t152 + t335 - t304) * t219 * t343
    out_tvalues[26, :] = (t211 * t35 + t212 * t36) * t201
    out_tvalues[27, :] = 0.231e3 / 0.16e2 * t155 - 0.315e3 / 0.16e2 * t153 + 0.105e3 / 0.16e2 * t108 - 0.5e1 / 0.16e2
    out_tvalues[28, :] = t118 * t80 * (t332 + 3 * t108 + t310) * t279
    out_tvalues[29, :] = (t73 + t304) * t219 * t344
    out_tvalues[30, :] = (t211 * t29 + t212 * t30) * t201
    out_tvalues[31, :] = -t65 * t226
    out_tvalues[32, :] = (t196 * t23 + t197 * t24) * t246
    out_tvalues[33, :] = t64 * t187
    out_tvalues[34, :] = (t17 * t210 + t18 * t213) * t191
    out_tvalues[35, :] = t63 * t224
    out_tvalues[36, :] = (t208 * t21 + t209 * t22) * t281
    out_tvalues[37, :] = (-0.3e1 / 0.16e2*1j) * t62 * t163 * t292
    out_tvalues[38, :] = (t236 * t27 + t237 * t28 + t312) * t190
    out_tvalues[39, :] = -t61 * t258
    out_tvalues[40, :] = (t15 * t192 + t16 * t193) * t274
    out_tvalues[41, :] = t134 * ((-t249 + t266) * t32 + (t259 + t271) * t31) * t227
    out_tvalues[42, :] = -(t177 * t45 + t178 * t46) * t274
    out_tvalues[43, :] = (-1*1j) * (t175 * t33 + t176 * t34 + t303) * t223
    out_tvalues[44, :] = -(t194 * t39 + t195 * t40 + t314) * t280
    out_tvalues[45, :] = ((t321 - t182) * t44 + (t321 - t179) * t43) * t203
    out_tvalues[46, :] = -(t183 * t41 - t184 * t42) * t247
    out_tvalues[47, :] = (-1*1j) * (t171 * t35 + t172 * t36) * t225
    out_tvalues[48, :] = (-1*1j) * np.sqrt(0.3003e4) * t114 * np.sin(t139) * t98 * t279
    out_tvalues[49, :] = (t171 * t29 + t172 * t30) * t204
    out_tvalues[50, :] = -(-t183 * t23 + t184 * t24) * t247
    out_tvalues[51, :] = (t17 * t179 + t18 * t182 + t313) * t203
    out_tvalues[52, :] = (t194 * t21 + t195 * t22 + t315) * t280
    out_tvalues[53, :] = (1j) * (t175 * t27 + t176 * t28 + t312) * t223
    out_tvalues[54, :] = (t15 * t177 + t16 * t178) * t274
    out_tvalues[55, :] = (1j) * t134 * ((-t259 + t271) * t26 + (t249 + t266) * t25) * t253
    out_tvalues[56, :] = np.exp((-8*1j) * phi1) * t255
    out_tvalues[57, :] = (t181 * np.exp((-2*1j) * t86) + t180 * np.exp((-2*1j) * t85)) * t275
    out_tvalues[58, :] = (-4 * t152 + 6 * t108 - 4 * t114 + t309) * np.exp((-7*1j) * phi1) * t55 * t206
    out_tvalues[59, :] = t129 * ((t229 + t240) * t32 + (t233 - t242) * t31) * t227
    out_tvalues[60, :] = -t72 * t230
    out_tvalues[61, :] = (t173 * t45 + t174 * t46) * t274
    out_tvalues[62, :] = t71 * t189
    out_tvalues[63, :] = (t165 * t33 + t166 * t34) * t202
    out_tvalues[64, :] = t70 * t217
    out_tvalues[65, :] = (t185 * t39 + t186 * t40 + t314) * t282
    out_tvalues[66, :] = t69 * t188
    out_tvalues[67, :] = ((t319 + t170) * t44 + (t319 + t169) * t43) * t205
    out_tvalues[68, :] = -t68 * t231
    out_tvalues[69, :] = (t198 * t41 + t199 * t42) * t216
    out_tvalues[70, :] = (715 * t103 - 1001 * t105 + 385 * t152 - 35 * t114 - t238) * t218 * t343
    out_tvalues[71, :] = (t167 * t35 + t168 * t36) * t204
    out_tvalues[72, :] = 0.6435e4 / 0.128e3 * t157 - 0.3003e4 / 0.32e2 * t155 + 0.3465e4 / 0.64e2 * t153 - 0.315e3 / 0.32e2 * t108 + 0.35e2 / 0.128e3
    out_tvalues[73, :] = t116 * (t75 + t261) * t80 * t278
    out_tvalues[74, :] = t238 * t218 * t344
    out_tvalues[75, :] = (t167 * t29 + t168 * t30) * t204
    out_tvalues[76, :] = -t65 * t231
    out_tvalues[77, :] = (t198 * t23 + t199 * t24) * t216
    out_tvalues[78, :] = t64 * t188
    out_tvalues[79, :] = (t169 * t17 + t170 * t18 + t313) * t205
    out_tvalues[80, :] = t63 * t217
    out_tvalues[81, :] = (t185 * t21 + t186 * t22 + t315) * t282
    out_tvalues[82, :] = t62 * t189
    out_tvalues[83, :] = (t165 * t27 + t166 * t28) * t202
    out_tvalues[84, :] = -t61 * t230
    out_tvalues[85, :] = (t15 * t173 + t16 * t174) * t274
    out_tvalues[86, :] = np.exp((7*1j) * phi1) * t78 * t163 * t206
    out_tvalues[87, :] = (-1*1j) * t129 * ((t233 + t242) * t26 + (t229 - t240) * t25) * t253
    out_tvalues[88, :] = np.exp((8*1j) * phi1) * t255
    out_tvalues[89, :] = (t181 * np.exp((2*1j) * t86) + t180 * np.exp((2*1j) * t85)) * t275

    return out_tvalues

if __name__ == '__main__':
    tvals = gsh(np.array([[.1], [.2], [.3]]))
    print tvals

