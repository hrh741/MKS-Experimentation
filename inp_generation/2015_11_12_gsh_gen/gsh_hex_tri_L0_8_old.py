import numpy as np


def gsh(e_angles):

    phi1 = e_angles[0, :]
    phi = e_angles[1, :]
    phi2 = e_angles[2, :]

    zvec = np.abs(phi) < 10e-17
    zvec = zvec.astype(int)
    randvec = np.round(np.random.rand(zvec.shape[0]))
    randvecopp = np.ones(zvec.shape[0]) - randvec
    phi += (1e-7)*zvec*(randvec - randvecopp)

    out_tvalues = np.zeros([90, e_angles.shape[1]], dtype = 'complex128')

    t111 = np.cos(phi)
    t105 = t111 ** 2
    t72 = -18 * t105
    t344 = 1 + t72
    t150 = t105 ** 2
    t149 = t111 * t105
    t152 = t149 ** 2
    t154 = t150 ** 2
    t220 = 15 * t154 - 46 * t152 + 48 * t150 + t344
    t74 = 1 + t111
    t144 = np.sqrt(t74)
    t156 = t144 * t74
    t157 = t74 * t156
    t280 = 0.51e2 / 0.64e2 * t111
    t343 = t157 * t280
    t100 = t111 * t152
    t342 = 7 * t100
    t102 = t111 * t150
    t341 = -4 * t102
    t340 = 2 * t105
    t76 = 7 * t105
    t339 = -6 * t111
    t338 = -3 * t111
    t337 = -2 * t111
    t336 = 5 * t111
    t335 = 2 * t149
    t334 = -3 * t150
    t333 = 5 * t150
    t332 = 4 * t154
    t331 = 7 * t154
    t98 = t111 * t154
    t330 = 20 * t98
    t329 = -21 * t102
    t328 = -14 * t102
    t327 = -14 * t105
    t326 = -10 * t105
    t325 = 10 * t105
    t324 = 15 * t105
    t323 = -38 * t149
    t322 = -35 * t149
    t321 = -22 * t149
    t320 = 21 * t149
    t319 = 22 * t149
    t318 = -35 * t150
    t317 = -20 * t150
    t316 = 20 * t150
    t315 = 35 * t150
    t136 = 6 * phi2
    t141 = 5 * phi1
    t80 = t141 + t136
    t30 = np.exp((-1*1j) * t80)
    t139 = -6 * phi2
    t81 = t141 + t139
    t31 = np.exp((-1*1j) * t81)
    t314 = t30 * t325 + t31 * t326
    t137 = 3 * phi2
    t143 = 2 * phi1
    t84 = t143 + t137
    t36 = np.exp((-2*1j) * t84)
    t138 = -3 * phi2
    t85 = t143 + t138
    t37 = np.exp((-2*1j) * t85)
    t313 = (t36 + t37) * t317
    t88 = phi1 + 2 * phi2
    t40 = np.exp((-3*1j) * t88)
    t91 = phi1 - 2 * phi2
    t41 = np.exp((-3*1j) * t91)
    t312 = (t40 + t41) * t319
    t311 = -1 + t152
    t310 = 1 + t150
    t309 = 1 + t333
    t308 = 1 + t152
    t57 = 5 * t105 - 1
    t75 = 1 - t111
    t145 = np.sqrt(t75)
    t52 = 0.1e1 / t145
    t307 = (1j) * t52
    t306 = 1 + t326
    t305 = 5 - 30 * t105
    t135 = np.sqrt(0.2e1)
    t304 = t135 * np.cos(t136)
    t303 = t144 * t52
    t48 = 0.1e1 / t144
    t302 = t145 * t48
    t301 = t111 * t156
    t300 = t144 * t145
    t299 = 6 * t100 + t339
    t298 = t341 + 4 * t111
    t297 = t149 + 3 * t111
    t296 = t340 - t310
    t295 = 1 + t340 + t334
    t294 = 1 + 21 * t105 + 7 * t152
    t293 = 4 - 8 * t105 + 24 * t152
    t292 = (-1*1j) * t300
    t291 = t111 * np.sqrt(0.77e2) * t157
    t290 = t111 * t300
    t159 = t145 * t75
    t289 = t159 * t301
    t132 = np.sqrt(0.6e1)
    t110 = np.sin(phi)
    t97 = t110 ** 2
    t288 = -0.5e1 / 0.4e1 * t132 * t97
    t287 = 2 * t100 + t341 + t335
    t286 = -2 * t102 + t337 + 4 * t149
    t285 = t102 + t338 + t335
    t284 = t102 + t111 - 2 * t149
    t283 = -6 * t102 + t339 - 20 * t149
    t282 = t102 + t336 + 10 * t149
    t281 = 18 * t100 - 38 * t102 + t337
    t113 = np.sqrt(0.429e3)
    t279 = 0.17e2 / 0.64e2 * t113
    t278 = 0.17e2 / 0.64e2 * np.sqrt(0.273e3)
    t277 = 0.13e2 / 0.32e2 * np.sqrt(0.231e3)
    t276 = 0.13e2 / 0.64e2 * np.sqrt(0.33e2)
    t128 = np.sqrt(0.13e2)
    t275 = 0.15e2 / 0.64e2 * t128
    t126 = np.sqrt(0.15e2)
    t274 = 0.17e2 / 0.128e3 * t126
    t273 = 0.15e2 / 0.128e3 * np.sqrt(0.7e1)
    t272 = 0.13e2 / 0.128e3 * t135
    t271 = 0.15e2 / 0.128e3 * t135
    t270 = 0.17e2 / 0.128e3 * t135
    t269 = -5 * t105 + t333 + t311
    t268 = 7 * t150 - 3 * t152 - t57
    t267 = 1 + 9 * t105 - 5 * t150 - 5 * t152
    t266 = -t105 - t150 + t308
    t64 = np.exp((-1*1j) * phi1)
    t265 = t111 * t64 * t303
    t264 = 6 * t152 + 5 * t154 - t306
    t63 = np.exp((1j) * phi1)
    t263 = t63 * t290
    t262 = -0.9e1 / 0.8e1 * np.sqrt(0.10e2) * (t76 - 1) * t97
    t261 = -3 - 35 * t105 + 63 * t152 + t332
    t260 = -1 + t154 + t327 + 14 * t152
    t259 = t324 + 15 * t150 + t308
    t258 = 5 - 60 * t150 + 38 * t152 + t331
    t256 = 2 - 16 * t105 + 26 * t150 - 12 * t152
    t255 = 6 + 48 * t105 - 50 * t150 - 36 * t152
    t254 = t100 + 9 * t102 - 5 * t111 - 5 * t149
    t253 = t342 - 11 * t102 + t297
    t252 = 0.17e2 / 0.128e3 * t307
    t146 = t97 ** 2
    t95 = t97 * t146
    t251 = t95 * t277
    t250 = 0.9e1 / 0.16e2 * np.sqrt(0.70e2) * t146
    t249 = 0.15e2 / 0.128e3 * t48 * t52
    t248 = -14 * t100 + t328 + t339 + 12 * t98
    t247 = t328 + 14 * t149 - t299
    t246 = -t100 + t329 - 7 * t111 + t322
    t245 = -18 * t102 + 18 * t149 + t299
    t244 = t342 + 19 * t102 + 9 * t111 + t322
    t243 = t111 + 15 * t100 + t329 + 5 * t149
    t109 = np.sqrt(0.1430e4)
    t242 = 0.51e2 / 0.256e3 * t109 * t146 ** 2
    t123 = np.sqrt(0.35e2)
    t241 = (0.9e1 / 0.4e1*1j) * t123 * t301
    t240 = 16 - 210 * t150 + 196 * t152 + 30 * t154
    t239 = -17 * t100 + 7 * t102 - 11 * t111 + t320
    t238 = -7 * t100 - 69 * t102 + 29 * t111 + 15 * t149
    t117 = np.sqrt(0.143e3)
    t237 = t117 * t271
    t121 = np.sqrt(0.55e2)
    t236 = 0.39e2 / 0.128e3 * t121 * t135
    t235 = -25 * t100 - 77 * t102 + 17 * t111 + t320
    t234 = 30 * t100 - 10 * t102 + 18 * t111 + t323
    t233 = 715 * t152 - 1001 * t150 + 385 * t105 - 35
    t232 = t282 - t309
    t231 = t282 + t309
    t230 = -135 * t100 + t329 - 51 * t111 + 175 * t149
    t229 = 3 + t72 + t316 + 2 * t152 - 7 * t154
    t228 = 3 + t76 + t318 + 21 * t152 + t332
    t227 = 0.51e2 / 0.64e2 * (143 * t152 - 143 * t150 + 33 * t105 - 1) * t123 * t97
    t226 = 24 * t150 - 22 * t152 + t331 + t306
    t225 = (-1*1j) * t249
    t224 = t48 * t252
    t118 = np.sqrt(0.105e3)
    t70 = 33 * t150
    t223 = 0.13e2 / 0.32e2 * (t70 + t344) * t118 * t97
    t222 = (t324 - 1) * t95 * t279
    t221 = -7 + 42 * t105 + t317 - 90 * t152 + 75 * t154
    t219 = 1 + t327 + 52 * t150 - 66 * t152 + 27 * t154
    t218 = t113 * t249
    t73 = -26 * t105
    t217 = 0.51e2 / 0.128e3 * np.sqrt(0.154e3) * t146 * (65 * t150 + t73 + 1)
    t71 = 11 * t105
    t216 = 0.39e2 / 0.32e2 * np.sqrt(0.14e2) * t146 * (t71 - 1)
    t215 = t135 * t144 * t280
    t214 = (-0.5e1 / 0.2e1*1j) * t132 * t290
    t213 = -66 * t100 + 78 * t102 + 6 * t111 + t323 + t330
    t212 = np.sqrt(0.15015e5) * t111 * t270
    t211 = t285 + t295
    t210 = t284 + t296
    t209 = t284 - t296
    t208 = t285 - t295
    t207 = t269 + t298
    t206 = t269 - t298
    t205 = 62 * t100 - 162 * t102 - 10 * t111 + 90 * t149 + t330
    t204 = t117 * t225
    t203 = t128 * t225
    t202 = (1j) * t109 * t74 * t343
    t201 = np.sqrt(0.455e3) * t224
    t200 = t113 * t224
    t199 = np.sqrt(0.21e2) * t224
    t198 = 0.39e2 / 0.32e2 * np.sqrt(0.11e2) * t292
    t197 = 0.13e2 / 0.64e2 * t135 * t292
    t196 = (0.13e2 / 0.16e2*1j) * t118 * (t71 - 3) * t289
    t195 = t268 + t287
    t194 = -t268 + t287
    t193 = t266 + t286
    t192 = t266 - t286
    t191 = -t244 + t293
    t190 = t244 + t293
    t189 = t259 + t283
    t188 = t259 - t283
    t187 = t121 * t197
    t186 = np.sqrt(0.3e1) * t197
    t185 = -t243 + t264
    t184 = t243 + t264
    t160 = t75 * t159
    t183 = (-1*1j) * np.sqrt(0.2002e4) * t160 * t57 * t343
    t182 = (0.17e2 / 0.64e2*1j) * (39 * t150 + t73 + 3) * np.sqrt(0.2310e4) * t289
    t181 = t247 + t260
    t180 = -t247 + t260
    t179 = t253 + t256
    t178 = t253 - t256
    t177 = -t229 + t281
    t176 = t229 + t281
    t175 = t238 + t255
    t174 = -t238 + t255
    t173 = t234 - t258
    t172 = t234 + t258
    t171 = t230 + t240
    t170 = -t230 + t240
    t169 = t226 + t245
    t168 = -t226 + t245
    t167 = t219 + t248
    t166 = -t219 + t248
    t165 = t213 + t220
    t164 = t213 - t220
    t163 = t205 + t221
    t162 = t205 - t221
    t142 = 4 * phi1
    t140 = 7 * phi1
    t133 = np.sqrt(0.5e1)
    t122 = np.sqrt(0.42e2)
    t93 = phi1 + t139
    t92 = phi1 + t138
    t90 = phi1 - phi2
    t89 = phi1 + phi2
    t87 = phi1 + t137
    t86 = phi1 + t136
    t83 = t142 + t138
    t82 = t142 + t137
    t79 = t140 + t139
    t78 = t140 + t136
    t69 = np.exp((-6*1j) * phi1)
    t68 = np.exp((-5*1j) * phi1)
    t67 = np.exp((-4*1j) * phi1)
    t66 = np.exp((-3*1j) * phi1)
    t65 = np.exp((-2*1j) * phi1)
    t62 = np.exp((2*1j) * phi1)
    t61 = np.exp((3*1j) * phi1)
    t60 = np.exp((4*1j) * phi1)
    t59 = np.exp((5*1j) * phi1)
    t58 = np.exp((6*1j) * phi1)
    t43 = np.exp((-6*1j) * t90)
    t42 = np.exp((-6*1j) * t89)
    t39 = np.exp((-2*1j) * t92)
    t38 = np.exp((-2*1j) * t87)
    t33 = np.exp((-1*1j) * t93)
    t32 = np.exp((-1*1j) * t86)
    t29 = np.exp((-1*1j) * t79)
    t28 = np.exp((-1*1j) * t78)
    t27 = np.exp((1j) * t93)
    t26 = np.exp((1j) * t86)
    t25 = np.exp((1j) * t81)
    t24 = np.exp((1j) * t80)
    t23 = np.exp((1j) * t79)
    t22 = np.exp((1j) * t78)
    t21 = np.exp((2*1j) * t92)
    t20 = np.exp((2*1j) * t87)
    t19 = np.exp((2*1j) * t85)
    t18 = np.exp((2*1j) * t84)
    t15 = np.exp((3*1j) * t91)
    t14 = np.exp((3*1j) * t88)
    t13 = np.exp((6*1j) * t90)
    t12 = np.exp((6*1j) * t89)
    t8 = t29 * t315
    out_tvalues[0, :] = 1
    out_tvalues[1, :] = t65 * t288
    out_tvalues[2, :] = t64 * t214
    out_tvalues[3, :] = 0.15e2 / 0.2e1 * t105 - 0.5e1 / 0.2e1
    out_tvalues[4, :] = t63 * t214
    out_tvalues[5, :] = t62 * t288
    out_tvalues[6, :] = t67 * t250
    out_tvalues[7, :] = (t105 + t337 + 1) * t66 * t52 * t241
    out_tvalues[8, :] = t65 * t262
    out_tvalues[9, :] = (0.9e1 / 0.4e1*1j) * t133 * (7 * t149 - 7 * t105 + t338 + 3) * t265
    out_tvalues[10, :] = 0.315e3 / 0.8e1 * t150 - 0.135e3 / 0.4e1 * t105 + 0.27e2 / 0.8e1
    out_tvalues[11, :] = (-0.9e1 / 0.4e1*1j) * t133 * (t76 - 3) * t263
    out_tvalues[12, :] = t62 * t262
    out_tvalues[13, :] = t61 * t159 * t241
    out_tvalues[14, :] = t60 * t250
    out_tvalues[15, :] = -t69 * t251
    out_tvalues[16, :] = (t188 * t42 + t189 * t43) * t272
    out_tvalues[17, :] = (0.39e2 / 0.16e2*1j) * (-1 - 3 * t105 + t297) * t68 * t52 * t291
    out_tvalues[18, :] = (t231 * t30 + t232 * t31 + t314) * t186
    out_tvalues[19, :] = t67 * t216
    out_tvalues[20, :] = (t206 * t36 + t207 * t37) * t276
    out_tvalues[21, :] = t66 * t196
    out_tvalues[22, :] = (t208 * t40 + t211 * t41) * t187
    out_tvalues[23, :] = -t65 * t223
    out_tvalues[24, :] = (t192 * t38 + t193 * t39) * t236
    out_tvalues[25, :] = (0.13e2 / 0.16e2*1j) * t122 * (33 * t102 - 33 * t150 - 30 * t149 + t336 - t305) * t265
    out_tvalues[26, :] = (t209 * t32 + t210 * t33) * t198
    out_tvalues[27, :] = 0.3003e4 / 0.16e2 * t152 - 0.4095e4 / 0.16e2 * t150 + 0.1365e4 / 0.16e2 * t105 - 0.65e2 / 0.16e2
    out_tvalues[28, :] = (t334 + 3 * t105 + t311) * t277 * t304
    out_tvalues[29, :] = (-0.13e2 / 0.16e2*1j) * t122 * (t70 + t305) * t263
    out_tvalues[30, :] = (t209 * t26 + t210 * t27) * t198
    out_tvalues[31, :] = -t62 * t223
    out_tvalues[32, :] = (t192 * t20 + t193 * t21) * t236
    out_tvalues[33, :] = t61 * t196
    out_tvalues[34, :] = (t14 * t208 + t15 * t211) * t187
    out_tvalues[35, :] = t60 * t216
    out_tvalues[36, :] = (t18 * t206 + t19 * t207) * t276
    out_tvalues[37, :] = (-0.39e2 / 0.16e2*1j) * t59 * t160 * t291
    out_tvalues[38, :] = ((t326 + t232) * t25 + (t325 + t231) * t24) * t186
    out_tvalues[39, :] = -t58 * t251
    out_tvalues[40, :] = (t12 * t188 + t13 * t189) * t272
    out_tvalues[41, :] = (-1*1j) * (t8 + (t246 + t294) * t29 + (t254 - t267) * t28) * t273 * t303
    out_tvalues[42, :] = (t174 * t43 + t175 * t42) * t271
    out_tvalues[43, :] = (t172 * t30 + t173 * t31 + t314) * t203
    out_tvalues[44, :] = -(t190 * t36 + t191 * t37 + t313) * t275
    out_tvalues[45, :] = (t176 * t41 + t177 * t40 + t312) * t204
    out_tvalues[46, :] = -(t178 * t38 - t179 * t39) * t237
    out_tvalues[47, :] = (-1*1j) * (t168 * t33 + t169 * t32) * t218
    out_tvalues[48, :] = (-0.15e2 / 0.32e2*1j) * np.sqrt(0.3003e4) * t135 * t111 * np.sin(t136) * t95
    out_tvalues[49, :] = (1j) * (t168 * t27 + t169 * t26) * t218
    out_tvalues[50, :] = -(-t178 * t20 + t179 * t21) * t237
    out_tvalues[51, :] = ((t321 - t176) * t15 + (t321 - t177) * t14) * t204
    out_tvalues[52, :] = -((t316 - t191) * t19 + (t316 - t190) * t18) * t275
    out_tvalues[53, :] = ((t325 - t173) * t25 + (t326 - t172) * t24) * t203
    out_tvalues[54, :] = -(t12 * t175 + t13 * t174) * t271
    out_tvalues[55, :] = (1j) * ((t254 + t267) * t23 + (t318 + t246 - t294) * t22) * t273 * t302
    out_tvalues[56, :] = np.exp((-8*1j) * phi1) * t242
    out_tvalues[57, :] = (t181 * np.exp((-2*1j) * t83) + t180 * np.exp((-2*1j) * t82)) * t274
    out_tvalues[58, :] = (-4 * t149 + 6 * t105 - 4 * t111 + t310) * np.exp((-7*1j) * phi1) * t52 * t202
    out_tvalues[59, :] = t144 * t126 * (t8 + (t235 + t261) * t29 + (t228 - t239) * t28) * t252
    out_tvalues[60, :] = -t69 * t222
    out_tvalues[61, :] = (t170 * t42 + t171 * t43) * t270
    out_tvalues[62, :] = t68 * t183
    out_tvalues[63, :] = (t162 * t31 + t163 * t30) * t199
    out_tvalues[64, :] = t67 * t217
    out_tvalues[65, :] = (t184 * t36 + t185 * t37 + t313) * t278
    out_tvalues[66, :] = t66 * t182
    out_tvalues[67, :] = (t166 * t41 + t167 * t40 + t312) * t201
    out_tvalues[68, :] = -t65 * t227
    out_tvalues[69, :] = (t194 * t38 + t195 * t39) * t212
    out_tvalues[70, :] = t64 * (715 * t100 - 1001 * t102 + 385 * t149 - 35 * t111 - t233) * t215 * t307
    out_tvalues[71, :] = (t164 * t33 + t165 * t32) * t200
    out_tvalues[72, :] = 0.109395e6 / 0.128e3 * t154 - 0.51051e5 / 0.32e2 * t152 + 0.58905e5 / 0.64e2 * t150 - 0.5355e4 / 0.32e2 * t105 + 0.595e3 / 0.128e3
    out_tvalues[73, :] = t220 * t279 * t304
    out_tvalues[74, :] = (-1*1j) * t63 * t145 * t233 * t215
    out_tvalues[75, :] = (t164 * t27 + t165 * t26) * t200
    out_tvalues[76, :] = -t62 * t227
    out_tvalues[77, :] = (t194 * t20 + t195 * t21) * t212
    out_tvalues[78, :] = t61 * t182
    out_tvalues[79, :] = ((t319 + t166) * t15 + (t319 + t167) * t14) * t201
    out_tvalues[80, :] = t60 * t217
    out_tvalues[81, :] = ((t317 + t185) * t19 + (t317 + t184) * t18) * t278
    out_tvalues[82, :] = t59 * t183
    out_tvalues[83, :] = (t162 * t25 + t163 * t24) * t199
    out_tvalues[84, :] = -t58 * t222
    out_tvalues[85, :] = (t12 * t170 + t13 * t171) * t270
    out_tvalues[86, :] = np.exp((7*1j) * phi1) * t75 * t160 * t202
    out_tvalues[87, :] = (-1*1j) * ((t228 + t239) * t23 + (t315 - t235 + t261) * t22) * t274 * t302
    out_tvalues[88, :] = np.exp((8*1j) * phi1) * t242
    out_tvalues[89, :] = (t181 * np.exp((2*1j) * t83) + t180 * np.exp((2*1j) * t82)) * t274

    return out_tvalues

if __name__ == '__main__':
    tvals = gsh(np.array([[.1], [.2], [.3]]))
    print tvals

