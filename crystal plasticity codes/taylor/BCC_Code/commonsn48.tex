	IMPLICIT REAL*8(A-H,O-Z)
	PARAMETER(MAXCRYS = 70000,MAXSLIP=48)
	COMMON/I1/LFLAG,NCRYS
        COMMON/A1/C11,C12,C44,TTIME,DTIME,TAUTO,DTMAX,OUT,TEX,PI,
     +     ONET(3,3),DELTA(6),ONES(6,6),GDO,XM,SO,QFAC
	COMMON/A2/EDOT,HO,SS,QL,AEXP,SEXP,ALPHA
	COMMON/A4/TIME,FPTINV(3,3,MAXCRYS),TBTMAT(3,3,MAXCRYS)
	COMMON/A3/TAU,FTAU(3,3),TBTR(3,3,MAXCRYS),A(3,3,MAXCRYS),
     +     QT(3,3,MAXCRYS),TBTAU(3,3,MAXCRYS),DGTAU(48,MAXCRYS),
     +     TTAU(3,3,MAXCRYS),FSTAU(3,3,MAXCRYS),FT(3,3),
     +     FTTAU(3,3),RSTAU(3,3,MAXCRYS)
	COMMON/A5/QMAT(3,3,MAXCRYS),CMAT(6,48,MAXCRYS),
     +     SMATG(3,3,48,MAXCRYS),PMAT(6,48,MAXCRYS),SMAT(3,3,48),
     +     CRSS(48,MAXCRYS),ACCGAM(48,MAXCRYS),NSYS(MAXCRYS),
     +     NSB(MAXCRYS)
        COMMON/SB1/AM(48,3),AN(48,3),SBTIME(MAXCRYS)
	COMMON/A6/AVGSTR(3,3),DGMAX(MAXCRYS),DGMAXG,QLAT(48,48)
        COMMON/A7/ONE,TWO,THREE,FOUR,HALF,THIRD,ZERO,TINY
        COMMON/A8/TH(MAXCRYS),PHI(MAXCRYS),OM(MAXCRYS)
        COMMON/W1/WSTAR(3,MAXCRYS)
        COMMON/W2/FTHETA

C $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C
C               ***** VARIABLE DEFINITIONS *****

C   MAXCRYS     : MAXIMUM NO. OF CRYSTALS, USED ONLY FOR DIMENSIONING
C                 VARIOUS DATA STRUCTURES.

C   MAXSLIP     : MAXMIMUM NO. OF SLIP SYSTEMS, USED ONLY FOR DIMENSON-
C                 VARIOUS DATA STRUCTURES.

C   C11,C12,C44 : ELASTIC MODULI.

C   TTIME       : TOTAL TIME OF ANALYSIS OR DURATION OF STEP WHEN RESTART
C                 IS USED.

C   DTIME       : TIME STEP. INITIALLY THIS VALUE IS READ FROM INPUT FILE.
C                 THIS TIME STEP IS MAINTAINED UNTIL TAUTO IS REACHED.

C   TAUTO       : TIME UPTO WHICH THE TIME STEPS ARE TAKEN EQUAL TO DTIME.
C                 AUTOMATIC TIME STEPPING KICKS IN AFTER TAUTO IS REACHED.

C   DTMAX       : MAXIMUM TIME STEP PERMITTED.

C   OUT         : INTERVALS (IN TIME) WHEN STRESSES ARE WRITTEN TO OUTPUT
C                 FILES.
 
C   TEX         : TIME WHEN EVOLVED TEXTURE IS OUTPUT IN THE FORM OF EULER
C                 ANGLES.

C   PI          : CONSTANT EQUAL TO 4*atan(1)

C   ONET        : UNIT 3*3 MATRIX (DIAGONALS = 1.0, OTHERS = 0.0).

C   DELTA       : VECTORISED UNIT MATRIX (1.0,1.0,1.0,0.0,0.0,0.0).

C   ONES        : UNIT 6*6 MATRIX (DIAGONALS = 1.0, OTHERS = 0.0).

C   GDO         : GAMMADOT_O (THE REFERENCE STRAIN RATE IN THE SLIP LAW).

C   XM          : STRAIN RATE SENSITIVITY (EXPONENT IN THE SLIP LAW).

C   SO          : INITIAL SLIP SYSTEM RESISTANCE.

C   LFLAG       : FLAG FOR LOADING CONDITIONS.
C                   1 = SIMPLE SHEAR (F(1,2) = GAMMA).
C                   2 = AXIAL TENSION/COMPRESSION (2 - AXIS).
C                   3 = PLANE STRAIN TENSION/COMPRESSION (2 - AXIS). 

C   EDOT        : STRAIN RATE, TO BE INTERPRETED BASED ON LFLAG.
C                   LFLAG = 1; SHEAR RATE.
C                   LFLAG = 2 OR 3; TRUE STRAIN RATE IN 2-AXIS.

C   HO          : HARDENING PARAMETER `H_O' IN HARDENING LAW. 

C   SS          : HARDENING PARAMETER `S^*' IN HARDENING LAW 

C   QL          : LATENT HARDENING `Q' PARAMETER IN HARDENING LAW.

C   AEXP        : EXPONENT `A' IN THE HARDENING LAW.

C   SEXP        : EXPONENT IN THE EQUATION FOR SATURATION STRESS.   

C   TIME        : TIME AT THE BEGINNING OF THE CURRENT TIME STEP.

C   FPTINV      : AN ARRAY STORING THE INVERSE OF PLASTIC DEFORMATION 
C                 GRADIENT AT THE BEGINNING OF THE TIME STEP FOR ALL 
C                 CRYSTALS.

C   TBTMAT      : AN ARRAY STORING THE SECOND P-K STRESS (BASED ON
C                 RELAXED CONFIGURATION) AT THE BEGINNING OF TIME 
C                 STEP FOR ALL CRYSTALS.
 
C   TAU         : TIME AT THE END OF CURRENT TIME STEP.

C   FTAU        : DEFORMATION GRADIENT AT THE END OF THE CURRENT STEP.

C   TBTR        : THE TRIAL STRESS TENSOR FOR ALL CRYSTAL.

C   A           : THE TENSOR AS DEFINED IN THE ALGORITHM FOR ALL CRYSTAL.

C   QT          : TRANSPOSE OF MATRIX QMAT.

C   TBTAU       : THE SECOND P-K STRESS IN RELAXED CONFIGURATION FOR ALL 
C                 CRYSTALS AT THE END OF THE TIME STEP.


C   DGTAU       : DELTA GAMMAS IN ALL CRYSTALS AT THE END OF THE TIME STEP.

C   TTAU        : THE CAUCHY STRESS IN ALL CRYSTALS AT THE END OF THE TIME 
C                 STEP.

C   FSTAU       : THE ELASTIC DEFORMATION GRADIENT IN ALL CRYSTALS AT THE 
C                 END OF THE TIME STEP.


C   FT          : DEFORMATION GRADIENT IN THE INITIAL CONFIGURATION. 
C                 NORMALLY EQUAL TO IDENTITY TENSOR EXCEPT WHEN RESTARTING
C                 FROM A PREVIOUS RUN.

C   FTTAU       : RELATIVE DEFORMATION GRADIENT WITH RESPECT TO THE INITIAL
C                 CONFIGURATION. NORMALLY EQUAL TO FTAU EXCEPT WHEN 
C                 RESTARTING FROM A PREVIOUS RUN.

C   NCRYS       : NO. OF CRYSTALS.

C   QMAT        : AN ARRAY STORING THE TRANSFORMATION MATRICES Q FOR ALL
C                 CRYSTALS.

C   CMAT        : AN ARRAY STORING THE TENSORS `C^ALPHA' FOR ALL CRYSTALS 
C                 IN A VECTOR FORM.

C   SMATG       : AN ARRAY STORING THE TENSORS `S_O^ALPHA' FOR ALL THE
C                 CRYSTALS.

C   PMAT        : AN ARRAY STORING THE SYMMETRIC PART OF SMATG IN THE 
C                 VECTOR FORM. 

C   SMAT        : AN ARRAY STORING THE TENSORS `S_O^ALPHA' FOR THE CRYSTAL. 

C   CRSS        : AN ARRAY STORING THE SLIP SYSTEM RESISTANCES FOR ALL
C                 CRYSTALS.

C   AVGSTR      : THE AVERAGE OF CAUCHY STRESSES OVER ALL THE CRYSTALS.

C   DGMAX       : THE MAXIMUM AMOUNT OF SLIP ON ANY SLIP SYSTEM IN THE
C                 CURRENT TIME STEP FOR EACH CRYSTAL.
C   DGMAXG      : THE MAXIMUM AMOUNT OF SLIP ON ALL CRYSTALS :max(DGMAX)

C   QLAT        : THE LATENT HARDENING MATRIX.

C $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
