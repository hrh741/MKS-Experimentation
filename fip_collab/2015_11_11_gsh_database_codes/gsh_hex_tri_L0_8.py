import numpy as np


def gsh(e_angles):

    phi1 = e_angles[0, :]
    phi = e_angles[1, :]
    phi2 = e_angles[2, :]

    zvec = np.abs(phi) < 10e-17
    zvec = zvec.astype(int)
    randvec = np.round(np.random.rand(zvec.shape[0]))
    randvecopp = np.ones(zvec.shape[0]) - randvec
    phi += (1e-7)*zvec*(randvec - randvecopp)

    out_tvalues = np.zeros([90, e_angles.shape[1]], dtype = 'complex128')

    t115 = np.cos(phi)
    t109 = t115 ** 2
    t76 = -18 * t109
    t350 = 1 + t76
    t79 = 1 - t115
    t149 = np.sqrt(t79)
    t56 = 0.1e1 / t149
    t68 = np.exp((-1*1j) * phi1)
    t349 = t56 * t68
    t67 = np.exp((1j) * phi1)
    t348 = (-1*1j) * t149 * t67
    t347 = (1j) * t349
    t154 = t109 ** 2
    t153 = t115 * t109
    t156 = t153 ** 2
    t158 = t154 ** 2
    t223 = 15 * t158 - 46 * t156 + 48 * t154 + t350
    t78 = 1 + t115
    t148 = np.sqrt(t78)
    t160 = t148 * t78
    t161 = t78 * t160
    t284 = 0.3e1 / 0.64e2 * t115
    t346 = t161 * t284
    t104 = t115 * t156
    t345 = -6 * t104
    t344 = 7 * t104
    t106 = t115 * t154
    t343 = -4 * t106
    t342 = 2 * t109
    t80 = 7 * t109
    t341 = -6 * t115
    t340 = -3 * t115
    t339 = -2 * t115
    t338 = 5 * t115
    t337 = 6 * t115
    t336 = 2 * t153
    t335 = -5 * t154
    t334 = -3 * t154
    t333 = -7 * t158
    t332 = 4 * t158
    t102 = t115 * t158
    t331 = 20 * t102
    t330 = -21 * t106
    t329 = -14 * t106
    t328 = -14 * t109
    t327 = -10 * t109
    t326 = 10 * t109
    t325 = 15 * t109
    t324 = -38 * t153
    t323 = -35 * t153
    t322 = -22 * t153
    t321 = 21 * t153
    t320 = 22 * t153
    t319 = -35 * t154
    t318 = -20 * t154
    t317 = 20 * t154
    t316 = 35 * t154
    t141 = 3 * phi2
    t147 = 2 * phi1
    t88 = t147 + t141
    t40 = np.exp((-2*1j) * t88)
    t142 = -3 * phi2
    t89 = t147 + t142
    t41 = np.exp((-2*1j) * t89)
    t315 = (t40 + t41) * t318
    t92 = phi1 + 2 * phi2
    t44 = np.exp((-3*1j) * t92)
    t95 = phi1 - 2 * phi2
    t45 = np.exp((-3*1j) * t95)
    t314 = (t44 + t45) * t320
    t140 = 6 * phi2
    t145 = 5 * phi1
    t84 = t145 + t140
    t28 = np.exp((1j) * t84)
    t143 = -6 * phi2
    t85 = t145 + t143
    t29 = np.exp((1j) * t85)
    t313 = t28 * t326 + t29 * t327
    t312 = -1 + t335
    t311 = -1 + t156
    t310 = 1 + t154
    t309 = 1 + t156
    t34 = np.exp((-1*1j) * t84)
    t35 = np.exp((-1*1j) * t85)
    t308 = t326 * t34 + t327 * t35
    t61 = 5 * t109 - 1
    t306 = 1 + t327
    t305 = 5 - 30 * t109
    t90 = phi1 + t140
    t30 = np.exp((1j) * t90)
    t97 = phi1 + t143
    t31 = np.exp((1j) * t97)
    t304 = (t30 + t31) * t337
    t302 = t148 * t149
    t301 = t343 + 4 * t115
    t300 = t153 + 3 * t115
    t299 = (0.1e1 / 0.4e1*1j) * t115
    t298 = t342 - t310
    t297 = 1 + t342 + t334
    t296 = 1 + 21 * t109 + 7 * t156
    t295 = 4 - 8 * t109 + 24 * t156
    t294 = (-1*1j) * t302
    t293 = t115 * np.sqrt(0.77e2) * t161
    t292 = t115 * t302
    t291 = 2 * t104 + t343 + t336
    t290 = -2 * t106 + t339 + 4 * t153
    t289 = t106 + t340 + t336
    t288 = t106 + t115 - 2 * t153
    t114 = np.sin(phi)
    t101 = t114 ** 2
    t136 = np.sqrt(0.6e1)
    t287 = -t101 * t136 / 0.4e1
    t286 = -6 * t106 + t341 - 20 * t153
    t285 = t106 + t338 + 10 * t153
    t283 = np.sqrt(0.273e3) / 0.64e2
    t282 = np.sqrt(0.33e2) / 0.64e2
    t132 = np.sqrt(0.13e2)
    t281 = t132 / 0.64e2
    t139 = np.sqrt(0.2e1)
    t280 = t139 / 0.32e2
    t279 = t139 / 0.64e2
    t278 = t56 / 0.128e3
    t277 = t345 + 18 * t106 - 18 * t153
    t276 = 18 * t104 - 38 * t106 + t339
    t130 = np.sqrt(0.15e2)
    t275 = t130 / 0.128e3
    t274 = t139 / 0.128e3
    t273 = -5 * t109 + 5 * t154 + t311
    t272 = 7 * t154 - 3 * t156 - t61
    t271 = 1 + 9 * t109 + t335 - 5 * t156
    t270 = -t109 - t154 + t309
    t269 = 6 * t156 + 5 * t158 - t306
    t163 = t149 * t79
    t268 = (1j) * t115 * t160 * t163
    t267 = -5 + 60 * t154 - 38 * t156 + t333
    t266 = -3 - 35 * t109 + 63 * t156 + t332
    t265 = -1 + t158 + t328 + 14 * t156
    t264 = t325 + 15 * t154 + t309
    t263 = -t101 * np.sqrt(0.10e2) * (t80 - 1) / 0.8e1
    t261 = 2 - 16 * t109 + 26 * t154 - 12 * t156
    t260 = 6 + 48 * t109 - 50 * t154 - 36 * t156
    t259 = t104 + 9 * t106 - 5 * t115 - 5 * t153
    t119 = np.sqrt(0.231e3)
    t150 = t101 ** 2
    t99 = t101 * t150
    t258 = t119 * t99 / 0.32e2
    t52 = 0.1e1 / t148
    t257 = t52 * t278
    t256 = t344 - 11 * t106 + t300
    t113 = np.sqrt(0.1430e4)
    t255 = 0.3e1 / 0.256e3 * t113 * t150 ** 2
    t254 = np.sqrt(0.70e2) * t150 / 0.16e2
    t253 = t148 * t278
    t252 = t149 * t52 / 0.128e3
    t251 = t345 + t329 + t337 + 14 * t153
    t250 = -t104 + t330 - 7 * t115 + t323
    t249 = t344 + 19 * t106 + 9 * t115 + t323
    t248 = t115 + 15 * t104 + t330 + 5 * t153
    t121 = np.sqrt(0.143e3)
    t247 = t121 * t274
    t125 = np.sqrt(0.55e2)
    t246 = 0.3e1 / 0.128e3 * t125 * t139
    t127 = np.sqrt(0.35e2)
    t245 = t127 * t160 * t299
    t244 = 16 - 210 * t154 + 196 * t156 + 30 * t158
    t243 = 12 * t102 - 14 * t104 + t329 + t341
    t242 = -17 * t104 + 7 * t106 - 11 * t115 + t321
    t241 = t344 + 69 * t106 - 29 * t115 - 15 * t153
    t240 = t331 - 66 * t104 + 78 * t106 + t324
    t239 = -25 * t104 - 77 * t106 + 17 * t115 + t321
    t238 = 30 * t104 - 10 * t106 + 18 * t115 + t324
    t237 = 715 * t156 - 1001 * t154 + 385 * t109 - 35
    t236 = t285 + t312
    t235 = t285 - t312
    t234 = -135 * t104 + t330 - 51 * t115 + 175 * t153
    t233 = 3 + t76 + t317 + 2 * t156 + t333
    t232 = 3 + t80 + t319 + 21 * t156 + t332
    t231 = (1j) * t257
    t230 = 0.3e1 / 0.64e2 * (143 * t156 - 143 * t154 + 33 * t109 - 1) * t101 * t127
    t117 = np.sqrt(0.429e3)
    t229 = (t117 * (t325 - 1) * t99) / 0.64e2
    t228 = 24 * t154 - 22 * t156 + 7 * t158 + t306
    t122 = np.sqrt(0.105e3)
    t74 = 33 * t154
    t227 = t101 * t122 * (t74 + t350) / 0.32e2
    t226 = t117 * t257
    t75 = 11 * t109
    t225 = 0.3e1 / 0.32e2 * np.sqrt(0.14e2) * t150 * (t75 - 1)
    t224 = t132 * t257
    t222 = 1 + t328 + 52 * t154 - 66 * t156 + 27 * t158
    t221 = 7 - 42 * t109 + t317 + 90 * t156 - 75 * t158
    t220 = t115 * np.sqrt(0.42e2) * t148 / 0.16e2
    t219 = t139 * t148 * t284
    t77 = -26 * t109
    t218 = 0.3e1 / 0.128e3 * np.sqrt(0.154e3) * (65 * t154 + t77 + 1) * t150
    t217 = np.sqrt(0.15015e5) * t115 * t274
    t216 = (-0.1e1 / 0.2e1*1j) * t136 * t292
    t215 = t289 + t297
    t214 = t288 + t298
    t213 = t288 - t298
    t212 = t289 - t297
    t211 = t273 + t301
    t210 = t273 - t301
    t209 = t331 + 62 * t104 - 162 * t106 - 10 * t115 + 90 * t153
    t208 = (-1*1j) * t226
    t207 = (-1*1j) * t121 * t257
    t206 = (1j) * t113 * t78 * t346
    t205 = np.sqrt(0.455e3) * t231
    t204 = (1j) * t226
    t203 = np.sqrt(0.21e2) * t231
    t202 = 0.3e1 / 0.32e2 * np.sqrt(0.11e2) * t294
    t201 = t279 * t294
    t200 = t272 + t291
    t199 = -t272 + t291
    t198 = t270 + t290
    t197 = t270 - t290
    t196 = -t249 + t295
    t195 = t249 + t295
    t194 = t264 + t286
    t193 = t264 - t286
    t192 = t125 * t201
    t191 = np.sqrt(0.3e1) * t201
    t164 = t79 * t163
    t190 = (-1*1j) * np.sqrt(0.2002e4) * t164 * t61 * t346
    t189 = np.sqrt(0.2310e4) * (39 * t154 + t77 + 3) * t268 / 0.64e2
    t188 = (t122 * (t75 - 3) * t268) / 0.16e2
    t187 = -t248 + t269
    t186 = t248 + t269
    t185 = t256 + t261
    t184 = t256 - t261
    t183 = t233 + t276
    t182 = t251 + t265
    t181 = -t251 + t265
    t180 = -t233 + t276
    t179 = -t228 + t277
    t178 = t228 + t277
    t177 = t241 + t260
    t176 = t241 - t260
    t175 = t238 + t267
    t174 = t238 - t267
    t173 = t234 + t244
    t172 = -t234 + t244
    t171 = -t222 + t243
    t170 = t222 + t243
    t169 = -t223 + t240
    t168 = t223 + t240
    t167 = t209 + t221
    t166 = t209 - t221
    t146 = 4 * phi1
    t144 = 7 * phi1
    t137 = np.sqrt(0.5e1)
    t135 = np.sqrt(0.7e1)
    t96 = phi1 + t142
    t94 = phi1 - phi2
    t93 = phi1 + phi2
    t91 = phi1 + t141
    t87 = t146 + t142
    t86 = t146 + t141
    t83 = t144 + t143
    t82 = t144 + t140
    t81 = np.cos(t140)
    t73 = np.exp((-6*1j) * phi1)
    t72 = np.exp((-5*1j) * phi1)
    t71 = np.exp((-4*1j) * phi1)
    t70 = np.exp((-3*1j) * phi1)
    t69 = np.exp((-2*1j) * phi1)
    t66 = np.exp((2*1j) * phi1)
    t65 = np.exp((3*1j) * phi1)
    t64 = np.exp((4*1j) * phi1)
    t63 = np.exp((5*1j) * phi1)
    t62 = np.exp((6*1j) * phi1)
    t47 = np.exp((-6*1j) * t94)
    t46 = np.exp((-6*1j) * t93)
    t43 = np.exp((-2*1j) * t96)
    t42 = np.exp((-2*1j) * t91)
    t37 = np.exp((-1*1j) * t97)
    t36 = np.exp((-1*1j) * t90)
    t33 = np.exp((-1*1j) * t83)
    t32 = np.exp((-1*1j) * t82)
    t27 = np.exp((1j) * t83)
    t26 = np.exp((1j) * t82)
    t25 = np.exp((2*1j) * t96)
    t24 = np.exp((2*1j) * t91)
    t23 = np.exp((2*1j) * t89)
    t22 = np.exp((2*1j) * t88)
    t19 = np.exp((3*1j) * t95)
    t18 = np.exp((3*1j) * t92)
    t17 = np.exp((6*1j) * t94)
    t16 = np.exp((6*1j) * t93)
    t4 = t33 * t316
    out_tvalues[0, :] = 1
    out_tvalues[1, :] = t69 * t287
    out_tvalues[2, :] = t68 * t216
    out_tvalues[3, :] = 0.3e1 / 0.2e1 * t109 - 0.1e1 / 0.2e1
    out_tvalues[4, :] = t67 * t216
    out_tvalues[5, :] = t66 * t287
    out_tvalues[6, :] = t71 * t254
    out_tvalues[7, :] = (t109 + t339 + 1) * t70 * t56 * t245
    out_tvalues[8, :] = t69 * t263
    out_tvalues[9, :] = t137 * t148 * (7 * t153 - 7 * t109 + t340 + 3) * t299 * t349
    out_tvalues[10, :] = 0.35e2 / 0.8e1 * t154 - 0.15e2 / 0.4e1 * t109 + 0.3e1 / 0.8e1
    out_tvalues[11, :] = (-0.1e1 / 0.4e1*1j) * t67 * t137 * (t80 - 3) * t292
    out_tvalues[12, :] = t66 * t263
    out_tvalues[13, :] = t65 * t163 * t245
    out_tvalues[14, :] = t64 * t254
    out_tvalues[15, :] = -t73 * t258
    out_tvalues[16, :] = (t193 * t46 + t194 * t47) * t274
    out_tvalues[17, :] = (0.3e1 / 0.16e2*1j) * (-1 - 3 * t109 + t300) * t72 * t56 * t293
    out_tvalues[18, :] = (t235 * t34 + t236 * t35 + t308) * t191
    out_tvalues[19, :] = t71 * t225
    out_tvalues[20, :] = (t210 * t40 + t211 * t41) * t282
    out_tvalues[21, :] = t70 * t188
    out_tvalues[22, :] = (t212 * t44 + t215 * t45) * t192
    out_tvalues[23, :] = -t69 * t227
    out_tvalues[24, :] = (t197 * t42 + t198 * t43) * t246
    out_tvalues[25, :] = (33 * t106 - 33 * t154 - 30 * t153 + t338 - t305) * t220 * t347
    out_tvalues[26, :] = (t213 * t36 + t214 * t37) * t202
    out_tvalues[27, :] = 0.231e3 / 0.16e2 * t156 - 0.315e3 / 0.16e2 * t154 + 0.105e3 / 0.16e2 * t109 - 0.5e1 / 0.16e2
    out_tvalues[28, :] = t119 * t81 * (t334 + 3 * t109 + t311) * t280
    out_tvalues[29, :] = (t74 + t305) * t220 * t348
    out_tvalues[30, :] = (t213 * t30 + t214 * t31) * t202
    out_tvalues[31, :] = -t66 * t227
    out_tvalues[32, :] = (t197 * t24 + t198 * t25) * t246
    out_tvalues[33, :] = t65 * t188
    out_tvalues[34, :] = (t18 * t212 + t19 * t215) * t192
    out_tvalues[35, :] = t64 * t225
    out_tvalues[36, :] = (t210 * t22 + t211 * t23) * t282
    out_tvalues[37, :] = (-0.3e1 / 0.16e2*1j) * t63 * t164 * t293
    out_tvalues[38, :] = (t235 * t28 + t236 * t29 + t313) * t191
    out_tvalues[39, :] = -t62 * t258
    out_tvalues[40, :] = (t16 * t193 + t17 * t194) * t274
    out_tvalues[41, :] = (-1*1j) * t135 * (t4 + (t250 + t296) * t33 + (t259 - t271) * t32) * t253
    out_tvalues[42, :] = -(t176 * t46 - t177 * t47) * t274
    out_tvalues[43, :] = (-1*1j) * (t174 * t34 + t175 * t35 + t308) * t224
    out_tvalues[44, :] = -(t195 * t40 + t196 * t41 + t315) * t281
    out_tvalues[45, :] = (t180 * t44 + t183 * t45 + t314) * t207
    out_tvalues[46, :] = -(t184 * t42 - t185 * t43) * t247
    out_tvalues[47, :] = ((t341 - t178) * t37 + (t341 - t179) * t36) * t208
    out_tvalues[48, :] = (-1*1j) * np.sqrt(0.3003e4) * t115 * np.sin(t140) * t99 * t280
    out_tvalues[49, :] = (t178 * t31 + t179 * t30 + t304) * t208
    out_tvalues[50, :] = -(-t184 * t24 + t185 * t25) * t247
    out_tvalues[51, :] = ((t322 - t183) * t19 + (t322 - t180) * t18) * t207
    out_tvalues[52, :] = -((t317 - t196) * t23 + (t317 - t195) * t22) * t281
    out_tvalues[53, :] = (1j) * (t174 * t28 + t175 * t29 + t313) * t224
    out_tvalues[54, :] = -(-t16 * t176 + t17 * t177) * t274
    out_tvalues[55, :] = (1j) * t135 * ((t259 + t271) * t27 + (t319 + t250 - t296) * t26) * t252
    out_tvalues[56, :] = np.exp((-8*1j) * phi1) * t255
    out_tvalues[57, :] = (t182 * np.exp((-2*1j) * t87) + t181 * np.exp((-2*1j) * t86)) * t275
    out_tvalues[58, :] = (-4 * t153 + 6 * t109 - 4 * t115 + t310) * np.exp((-7*1j) * phi1) * t56 * t206
    out_tvalues[59, :] = (1j) * t130 * (t4 + (t239 + t266) * t33 + (t232 - t242) * t32) * t253
    out_tvalues[60, :] = -t73 * t229
    out_tvalues[61, :] = (t172 * t46 + t173 * t47) * t274
    out_tvalues[62, :] = t72 * t190
    out_tvalues[63, :] = (t166 * t34 + t167 * t35) * t203
    out_tvalues[64, :] = t71 * t218
    out_tvalues[65, :] = (t186 * t40 + t187 * t41 + t315) * t283
    out_tvalues[66, :] = t70 * t189
    out_tvalues[67, :] = (t170 * t44 + t171 * t45 + t314) * t205
    out_tvalues[68, :] = -t69 * t230
    out_tvalues[69, :] = (t199 * t42 + t200 * t43) * t217
    out_tvalues[70, :] = (715 * t104 - 1001 * t106 + 385 * t153 - 35 * t115 - t237) * t219 * t347
    out_tvalues[71, :] = ((t337 + t169) * t37 + (t337 + t168) * t36) * t204
    out_tvalues[72, :] = 0.6435e4 / 0.128e3 * t158 - 0.3003e4 / 0.32e2 * t156 + 0.3465e4 / 0.64e2 * t154 - 0.315e3 / 0.32e2 * t109 + 0.35e2 / 0.128e3
    out_tvalues[73, :] = t117 * t223 * t81 * t279
    out_tvalues[74, :] = t237 * t219 * t348
    out_tvalues[75, :] = (t168 * t30 + t169 * t31 + t304) * t204
    out_tvalues[76, :] = -t66 * t230
    out_tvalues[77, :] = (t199 * t24 + t200 * t25) * t217
    out_tvalues[78, :] = t65 * t189
    out_tvalues[79, :] = ((t320 + t171) * t19 + (t320 + t170) * t18) * t205
    out_tvalues[80, :] = t64 * t218
    out_tvalues[81, :] = ((t318 + t187) * t23 + (t318 + t186) * t22) * t283
    out_tvalues[82, :] = t63 * t190
    out_tvalues[83, :] = (t166 * t28 + t167 * t29) * t203
    out_tvalues[84, :] = -t62 * t229
    out_tvalues[85, :] = (t16 * t172 + t17 * t173) * t274
    out_tvalues[86, :] = np.exp((7*1j) * phi1) * t79 * t164 * t206
    out_tvalues[87, :] = (-1*1j) * t130 * ((t232 + t242) * t27 + (t316 - t239 + t266) * t26) * t252
    out_tvalues[88, :] = np.exp((8*1j) * phi1) * t255
    out_tvalues[89, :] = (t182 * np.exp((2*1j) * t87) + t181 * np.exp((2*1j) * t86)) * t275

    return out_tvalues

if __name__ == '__main__':
    tvals = gsh(np.array([[.1], [.2], [.3]]))
    print tvals

